-- Fly Script
-- made by chatgpt and me lol

TOGGLE_KEY = "H" -- if its a letter it must be uppercase, if its a number it must be spelled out (1 = One)

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
local flying = false
local speed = 50

local bodyVelocity = nil

local bodyGyro = nil

local moveDirection = Vector3.new(0, 0, 0)

local function updateFlyDirection()
	if flying then
		if not bodyVelocity then
			bodyVelocity = Instance.new("BodyVelocity")
			bodyVelocity.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
			bodyVelocity.Parent = hrp
		end
		if not bodyGyro then
			bodyGyro = Instance.new("BodyGyro")
			bodyGyro.MaxTorque = Vector3.new(math.huge, math.huge, math.huge)
			bodyGyro.P = 3000
			bodyGyro.Parent = hrp
		end
		local camera = workspace.CurrentCamera
		local direction = camera.CFrame.LookVector * moveDirection.Z + camera.CFrame.RightVector * moveDirection.X
		bodyVelocity.Velocity = direction * speed + Vector3.new(0, moveDirection.Y * speed, 0)
		bodyGyro.CFrame = camera.CFrame
	end
end

local function toggleFly(set)
	flying = not flying
	if set then flying = set end
	if flying then
		RunService.RenderStepped:Connect(updateFlyDirection)
	else
		if bodyVelocity then bodyVelocity:Destroy() end
		if bodyGyro then bodyGyro:Destroy() end
		bodyVelocity = nil
		bodyGyro = nil
	end
end

local tp1 = UserInputService.InputBegan:Connect(function(input, gameProcessed)
	if gameProcessed then return end
	if input.KeyCode == key then
		toggleFly()
	elseif input.KeyCode == Enum.KeyCode.W then
		moveDirection = Vector3.new(moveDirection.X, moveDirection.Y, 1)
	elseif input.KeyCode == Enum.KeyCode.S then
		moveDirection = Vector3.new(moveDirection.X, moveDirection.Y, -1)
	elseif input.KeyCode == Enum.KeyCode.A then
		moveDirection = Vector3.new(-1, moveDirection.Y, moveDirection.Z)
	elseif input.KeyCode == Enum.KeyCode.D then
		moveDirection = Vector3.new(1, moveDirection.Y, moveDirection.Z)
	elseif input.KeyCode == Enum.KeyCode.E then
		moveDirection = Vector3.new(moveDirection.X, 1, moveDirection.Z)
	elseif input.KeyCode == Enum.KeyCode.Q then
		moveDirection = Vector3.new(moveDirection.X, -1, moveDirection.Z)
	end
end)

local tp2 = UserInputService.InputEnded:Connect(function(input, gameProcessed)
	if input.KeyCode == Enum.KeyCode.W or input.KeyCode == Enum.KeyCode.S then
		moveDirection = Vector3.new(moveDirection.X, moveDirection.Y, 0)
	elseif input.KeyCode == Enum.KeyCode.A or input.KeyCode == Enum.KeyCode.D then
		moveDirection = Vector3.new(0, moveDirection.Y, moveDirection.Z)
	elseif input.KeyCode == Enum.KeyCode.E or input.KeyCode == Enum.KeyCode.Q then
		moveDirection = Vector3.new(moveDirection.X, 0, moveDirection.Z)
	end
end)

player = game.Players.LocalPlayer
local function setVars()
	char = player.Character
	hum = char:WaitForChild("Humanoid")
	hrp = char:WaitForChild("HumanoidRootPart")
	head = char:WaitForChild("Head")
end
setVars()
local plrGui = player.PlayerGui
local uis = game.UserInputService
local mouse = player:GetMouse()
local gui = Instance.new("ScreenGui")
gui.DisplayOrder = 10000
gui.Parent = plrGui
script.Parent = gui
gui.ResetOnSpawn = false
local frame = Instance.new("Frame")
local dragUI = Instance.new("UIDragDetector")
dragUI.Parent = frame
frame.Size = UDim2.new(0.075, 0, 0.01, 0)
frame.BackgroundColor3 = Color3.new(0.9,0.9,0.9)
frame.BorderSizePixel = 0
frame.BackgroundTransparency = 0
frame.Position = UDim2.new(0.5, 0, 0.5, 0)
frame.AnchorPoint = Vector2.new(0.5, 0.5)
frame.Parent = gui
local label = Instance.new("TextLabel")
label.Parent = frame
label.Size = UDim2.new(1, 0, 1, 0)
label.BackgroundTransparency = 1
label.TextColor3 = Color3.new(0,0,0)
label.TextScaled = true
label.Text = "Fly Ability"
label.Parent = frame
label.TextTransparency = 0
local box = Instance.new("TextButton")
box.BorderSizePixel = 0
box.Visible = true
box.Text = "Click to disable script. Press "..TOGGLE_KEY.." to toggle!"
box.BackgroundTransparency = 0
box.Size = UDim2.new(1, 0, 10, 0)
box.TextColor = BrickColor.new("White")
box.Position = UDim2.new(0, 0, 1, 0)
box.Parent = frame
box.TextScaled = true
local min = Instance.new("TextButton")
min.BorderSizePixel = 0
min.Text = "-"
min.BackgroundColor3 = Color3.new(1,0,0)
min.BackgroundTransparency = 0
min.Size = UDim2.new(0.1, 0, 1, 0)
min.Position = UDim2.new(0.9, 0, 0, 0)
min.Parent = frame
min.TextScaled = true

local settingsSpeed = Instance.new("TextBox")
settingsSpeed.BorderSizePixel = 0
settingsSpeed.Visible = true
settingsSpeed.Text = tostring(speed)
settingsSpeed.PlaceholderText = "Speed"
settingsSpeed.BackgroundTransparency = 0
settingsSpeed.Size = UDim2.new(1, 0, 4, 0)
settingsSpeed.TextColor = BrickColor.new("White")
settingsSpeed.Position = UDim2.new(0, 0, 12.5, 0)
settingsSpeed.Parent = frame
settingsSpeed.TextScaled = true
settingsSpeed:GetPropertyChangedSignal("Text"):Connect(function()
	speed = tonumber(settingsSpeed.Text)
end)

local labelSpeed = Instance.new("TextLabel")
labelSpeed.Parent = frame
labelSpeed.Size = UDim2.new(1, 0, 2, 0)
labelSpeed.BackgroundTransparency = 0
labelSpeed.TextColor3 = Color3.new(0,0,0)
labelSpeed.BorderSizePixel = 0
labelSpeed.TextScaled = true
labelSpeed.Text = "Speed:"
labelSpeed.Position = UDim2.new(0, 0, 11, 0)
labelSpeed.TextStrokeTransparency = 1
labelSpeed.TextTransparency = 0
labelSpeed.TextWrapped = true

key = Enum.KeyCode[TOGGLE_KEY]
box.MouseButton1Click:Connect(function()
	toggleFly(false)
	tp1:Disconnect()
	tp2:Disconnect()
	gui:Destroy()
	script:Destroy()
end)
min.MouseButton1Click:Connect(function()
	box.Visible = not box.Visible
	settingsSpeed.Visible = not settingsSpeed.Visible
	labelSpeed.Visible = not labelSpeed.Visible
end)
player.CharacterAdded:Connect(function()
	setVars()
	toggleFly(false)
end)
